<html lang="en" xmlns:py="">
<script>
    $(()=> {
        $('#source-editor-save').on('click', e => {
            $.post(
                '${conf.root_url}/download/write_to_file',
                {
                    path: '${path}',
                    text: $('#source-editor-ta').val()
                }
            ).done(response => {location.reload()})
        })
    })
</script>
<div class="accordion">
    <div class="accordion-item">
        <div class="accordion-header" id="h-preview">
            <h5 class="mb-0">
                <button class="accordion-button" data-bs-toggle="collapse" data-bs-target="#preview" aria-expanded="true" aria-controls="preview">
                    File content
                </button>
            </h5>
        </div>

        <div id="preview" class="accordion-collapse collapse show" aria-labelledby="h-preview">
            <div class="accordion-body">
                    ${literal(html)}
            </div>
        </div>
    </div>
    <div class="accordion-item" py:if="is_member('editor')">
        <div class="accordion-header" id="h-source-editor">
            <h5 class="mb-0">
                <button class="accordion-button collapsed" data-bs-toggle="collapse" data-bs-target="#source-editor"
                        aria-expanded="false" aria-controls="source-editor">
                    <i class="fas fa-edit me-2"/>edit
                </button>
            </h5>
        </div>
        <div id="source-editor" class="accordion- collapse" aria-labelledby="h-source-editor" >
            <div class="accordion-body">
                <textarea id="source-editor-ta" class="form-control" rows="20">${literal(source)}</textarea>
            </div>
            <div>
                <button id="source-editor-save" class="btn btn-success">
                    <i class="fas fa-check"/> save
                </button>
                <a href="${conf.root_url}/help/odmf-markdown" class="btn btn-primary"
                   title="Help for formatting" data-bs-toggle="tooltip">
                    <i class="fas fa-question-circle" />
                </a>

            </div>
        </div>
    </div>

</div>
</html>