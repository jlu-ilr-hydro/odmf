<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:py="http://genshi.edgewall.org/">
<!--
TODO: Include filter for dataset.valuetype and dataset.measured_by. Move page home to /map/kml and use html-get
-->
<head>
	<link href="/media/iconilr.css" rel="stylesheet" type="text/css"/>
	<link href="/media/jquery-ui-1.8.18.custom.css" rel="stylesheet" type="text/css"/>

	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

	<title>schwingbach plot</title>
	
	<script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false"></script>	
	<script type="text/javascript" src="/media/jquery-1.7.1.min.js"></script> 
  <script src="/media/jquery-1.7.1.min.js" type="text/javascript" ></script>
  <script src="/media/jquery-ui-1.8.18.custom.min.js" type="text/javascript" ></script>
  <script src="/media/jquery.json-2.3.min.js" type="text/javascript"></script>

	<script type="text/javascript" src="/html/plot.js">
	</script>
	<script type="text/javascript">
    $(function() {
			$(".datepicker").datepicker({maxDate:"0", dateFormat: 'dd.mm.yy' });
			$(".timepicker").autocomplete({source: timerange(15)});
	    popSelect();
    });
</script>
	<style type="text/css">
	  .wide {width: 100%;}
	  .filter {width: 10em;}
	  .firstoption {font-style: italic;color: grey;}
	  .small {font-size: small; font-style: italic;}
  	.ui-autocomplete {
			max-height: 100px;
			overflow-y: auto;
			/* prevent horizontal scrollbar */
			overflow-x: hidden;
			/* add padding to account for vertical scrollbar */
			padding-right: 20px;
			font-size: small;
		}
	</style>
		
</head>
<body>
	${navigation()}
	<div class="content">
		<h1>Plot</h1>
		<div class="error" id="error"></div>
		<h2><a href="javascript:toggle('properties')">Properties</a></h2>
		<div id="properties">
			<div>
				start:
				<input class="datepicker" id="startdate" size="10" value="${formatdate(plot.startdate)}"/>
				<input class="timepicker" id="starttime" size="5" value="00:00" />
				end:
				<input class="datepicker" id="enddate" size="10" value="${formatdate(plot.enddate)}"/>
				<input class="timepicker" id="endtime" size="5" value="00:00" /> 
				size:<select id="sizeselect">
					<option value="320" py:attrs="markoption(int(plot.size[0]*100)==320)">320 x 240</option>
					<option value="640" py:attrs="markoption(int(plot.size[0]*100)==640)">640 x 480</option>
					<option value="800" py:attrs="markoption(int(plot.size[0]*100)==800)">800 x 600</option>
					<option value="1200" py:attrs="markoption(int(plot.size[0]*100)==1200)"	>1200 x 900</option>				
				</select>
				<button onclick="changeprops()">submit...</button>
			</div>
			<button onclick="$.post('clf',{},seterror);changeprops()"><img src="/media/shimmer/delete_16.png"/>clear plot</button>
			<!--
				Subplots
			-->
			<div py:for="sp in plot.subplots">
				<h3><img src="/media/shimmer/folder_32.png"/>Subplot ${sp.position}</h3>
				<a href="javascript:removesubplot(${sp.position})" class="small"><img src="/media/shimmer/delete_16.png"/>remove...</a><br/>
				<ul style="list-style-image: url(/media/shimmer/document_16.png)">
					<li py:for="i,l in enumerate(sp.lines)">
						${l}
						<a href="javascript:removeline(${sp.position},${i})" class="small"><img src="/media/shimmer/delete_16.png"/>remove...</a>
					</li>
				</ul>
			</div>
				<div py:if="plot.subplots">
					<h3>Add line to subplot</h3>
					<img src="/media/shimmer/document_add_32.png"/>
					sub plot: <select id="subplotselect">
						<option py:for="sp in plot.subplots" value="${sp.position}">#${sp.position}</option>
					</select>
						value:
						<select id="vtselect" onchange="popSelect();" class="filter">
							<option value="" class="firstoption">Please select...</option>
						</select>
						site:
						<select id="siteselect" onchange="popSelect();" class="filter">
							<option value="" class="firstoption">Please select...</option>
						</select>
						instrument:
						<select id="instrumentselect" onchange="popSelect();" class="filter">
							<option value="" class="firstoption">Please select...</option>
						</select>
						marker:
						<select id="markerpicker">
							<option value="">none</option>
							<option value="x">x</option>
							<option value="o">o</option>
							<option value=".">.</option>
							<option value="|">x</option>
							<option value="+">+</option>
							<option value="*">*</option>
						</select>
						line:
						<select id="linepicker">
							<option value="-">-</option>
							<option value="">none</option>
							<option value=":">:</option>
							<option value="--">--</option>
							<option value="-.">-.</option>
						</select>
						color:
						<select id="colorpicker">
							<option value="k" style="background-color: #000;">k</option>
							<option value="b" style="background-color: #00F;">b</option>
							<option value="g" style="background-color: #0F0;">g</option>
							<option value="r" style="background-color: #F00;">r</option>
							<option value="y" style="background-color: #FF0;">y</option>
							<option value="c" style="background-color: #0FF;">c</option>
							<option value="m" style="background-color: #F0F;">m</option>
						</select>
						<button onclick="addline()"><img src="/media/shimmer/document_add_16.png"/>Add line...</button> 
										
				</div>
	
			<div>
				<h3><a href="javascript:addsubplot()"><img src="/media/shimmer/folder_add_32.png"/>Add subplot</a></h3>
			</div>
			<div>
			</div>
		</div>
					
		<h2><a href="javascript:renderplot('plot','${plot.createtime}')">Load plot</a></h2>
		<div id="plot">
			
		</div>
	</div>

</body>
</html>